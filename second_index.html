<!DOCTYPE html>
<html>
	<head>
		<title>Prase Palindrome</title>
	</head>
	<body>
		<table>
			<tr>
				<td>Phrase: </td>
				<td><input id="phrase_input" type="text"></td>
			</tr>
			<tr>
				<td>Palindroms Number:</td>
				<td><input id="anagrams_num"></td>
			</tr>
			<tr>
				<td><button id="result">Show Result</button></td>
			</tr>
		</table>
		<div id="output_phrase"></div>
		<script type="text/javascript" src="english_words.js"></script>
		<script type="text/javascript">
			//var words_list --> english_words.js
			var button = document.getElementById("result");
			
			var anagram_phrases_array = [];
			var words_match_array = [];
			var potential_anagram = [];

			var anagrams_num;
			var input_string;
			var original_string;

			var word_index = 0;


			button.addEventListener("click", function() {

				anagrams_num = document.getElementById("anagrams_num").value;
				input_string = document.getElementById("phrase_input").value.replace(/\s/g, '');
				original_string = input_string;

				findPotentionalWordsForAnagram();				
				createAnagramPhrases();
			});

			function findPotentionalWordsForAnagram() {

				words_list.forEach(function(tmp_word) {

					var tmp_word_array = tmp_word.split("");

					input_string.split("").forEach(function(character) {
						if(tmp_word_array.includes(character)) {
							tmp_word_array.splice(tmp_word_array.indexOf(character), 1);
						}
					});

					if(tmp_word_array.length == 0) {
						words_match_array.push(tmp_word);
					}
				});
			}

			function createAnagramPhrases() {

				let input_string_array = input_string.split("");

				function checkWordInRemainingString(index) {

					let flag = true;

					words_match_array[index].split("").forEach(function(word_char) {
						
						if(input_string_array.includes(word_char)) {
							input_string_array.splice(input_string_array.indexOf(word_char), 1);
						}
						else {
							flag = false;
						}
					});

					return flag;
				}

				for(let i = word_index; i < words_match_array.length; i++) {

					//let input_string_array = input_string.split("");
					if(checkWordInRemainingString(i)) {
						potential_anagram.push({word: words_match_array[i], index: i});
						input_string = input_string_array.join("");
						console.log(input_string);
						console.log(...potential_anagram);
					}
				}

				let potential_anagram_str = "";
				for(let i = 0; i < potential_anagram.length; i++) {
					potential_anagram_str += potential_anagram[i].word;
				}		

				if(potential_anagram_str.length != original_string.length) {
					let last_word = potential_anagram.pop();

					if(last_word.index + 1 < words_match_array.length) {
						input_string += last_word.word;
						word_index = last_word.index + 1;
						createAnagramPhrases();
					}
				}
				else {
					anagram_phrases_array.push(potential_anagram);
				}
			}


			
		</script>
	</body>
</html>
